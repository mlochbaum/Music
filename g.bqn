#! /usr/bin/env dbqn

⟨⟨⟩,"",•path⟩⍎•FChars"synth.bqn"
lm←16×lb←⌊⌾(÷⟜100)0.73×fr

Primes ← 1e3⊸<◶((¬∘∊/⊣)⟜(⥊×⌜˜)2↓↕)‿{
  ∾⟜((1↓/)·∧´ (𝕩⥊0≠↕)¨) Primes 1+⌈√𝕩
}
pp←Primes 250e3

Poly ← {+⟜(𝕩⊸×)´𝕨}
b ← (¯1⌈1⌊ (¯2‿¯0.5‿10‿¯4 Poly ·Saw⥊⟜(Note"f#1")) × 1+0.4×·Sine·-⟜(≠÷˜fr|+´) 2.5‿¯1‿20‿¯14 Poly I) 2×lb
k ← 34 × ((2⋆¯10⊸×)⊸×∘I × (⊏⊸÷1.5⋆˜0.6+↕6) +˝∘× Sine∘⥊˘⟜(2+38×↕6)) lb
h ← ¯4‿1900 HShelf ⥊(2×lb) ↑⟜Add˘ (≍˜ -0.63‿1.5×lb) Shift⟜{(I 50) Fadefront (0.8‿¯0.2‿0.4 Poly I∘≠)⊸× ¯1+2×1|(π⋆1.5)|pp⊏˜𝕩+↕5e3}¨ 1e3×17‿3≍1‿4
c ← ¯1e3 ⌽ ∾ 0.3‿0.1‿1‿1 × (lb×2/3‿2÷5) ↑¨< 2e3 Lp1 ¯1.6×⋆-I 200

Out ↩ max × 2 Softclip 0.7⊸×
(2×lm) Write ⟨b,k,h,c⟩
